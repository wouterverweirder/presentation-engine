{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/isomorphic-fetch/fetch-npm-browserify.js","node_modules/whatwg-fetch/dist/fetch.umd.js","src/mobile/js/classes/Presentation.js","src/mobile/js/script.js","src/shared/js/Constants.js","src/shared/js/classes/MobileServerBridge.js","src/shared/js/classes/Presentation.js","src/shared/js/classes/SlideBridge.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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","file":"script.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","// the whatwg-fetch polyfill installs the fetch() function\n// on the global object (window or self)\n//\n// Return that as the export for use in Webpack, Browserify etc.\nrequire('whatwg-fetch');\nmodule.exports = self.fetch.bind(self);\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (factory((global.WHATWGFetch = {})));\n}(this, (function (exports) { 'use strict';\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob:\n      'FileReader' in self &&\n      'Blob' in self &&\n      (function() {\n        try {\n          new Blob();\n          return true\n        } catch (e) {\n          return false\n        }\n      })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  };\n\n  function isDataView(obj) {\n    return obj && DataView.prototype.isPrototypeOf(obj)\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ];\n\n    var isArrayBufferView =\n      ArrayBuffer.isView ||\n      function(obj) {\n        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n      };\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name);\n    }\n    if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value);\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift();\n        return {done: value === undefined, value: value}\n      }\n    };\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      };\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value);\n      }, this);\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1]);\n      }, this);\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name]);\n      }, this);\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    var oldValue = this.map[name];\n    this.map[name] = oldValue ? oldValue + ', ' + value : value;\n  };\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)];\n  };\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null\n  };\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  };\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  };\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this);\n      }\n    }\n  };\n\n  Headers.prototype.keys = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push(name);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.values = function() {\n    var items = [];\n    this.forEach(function(value) {\n      items.push(value);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.entries = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push([name, value]);\n    });\n    return iteratorFor(items)\n  };\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries;\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true;\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result);\n      };\n      reader.onerror = function() {\n        reject(reader.error);\n      };\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsArrayBuffer(blob);\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsText(blob);\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf);\n    var chars = new Array(view.length);\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i]);\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength);\n      view.set(new Uint8Array(buf));\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false;\n\n    this._initBody = function(body) {\n      this._bodyInit = body;\n      if (!body) {\n        this._bodyText = '';\n      } else if (typeof body === 'string') {\n        this._bodyText = body;\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body;\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body;\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString();\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer);\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer]);\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body);\n      } else {\n        this._bodyText = body = Object.prototype.toString.call(body);\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8');\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type);\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n      }\n    };\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this);\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      };\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      };\n    }\n\n    this.text = function() {\n      var rejected = consumed(this);\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    };\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      };\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    };\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT'];\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase();\n    return methods.indexOf(upcased) > -1 ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {};\n    var body = options.body;\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url;\n      this.credentials = input.credentials;\n      if (!options.headers) {\n        this.headers = new Headers(input.headers);\n      }\n      this.method = input.method;\n      this.mode = input.mode;\n      this.signal = input.signal;\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit;\n        input.bodyUsed = true;\n      }\n    } else {\n      this.url = String(input);\n    }\n\n    this.credentials = options.credentials || this.credentials || 'same-origin';\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers);\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET');\n    this.mode = options.mode || this.mode || null;\n    this.signal = options.signal || this.signal;\n    this.referrer = null;\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body);\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, {body: this._bodyInit})\n  };\n\n  function decode(body) {\n    var form = new FormData();\n    body\n      .trim()\n      .split('&')\n      .forEach(function(bytes) {\n        if (bytes) {\n          var split = bytes.split('=');\n          var name = split.shift().replace(/\\+/g, ' ');\n          var value = split.join('=').replace(/\\+/g, ' ');\n          form.append(decodeURIComponent(name), decodeURIComponent(value));\n        }\n      });\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers();\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ');\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':');\n      var key = parts.shift().trim();\n      if (key) {\n        var value = parts.join(':').trim();\n        headers.append(key, value);\n      }\n    });\n    return headers\n  }\n\n  Body.call(Request.prototype);\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {};\n    }\n\n    this.type = 'default';\n    this.status = options.status === undefined ? 200 : options.status;\n    this.ok = this.status >= 200 && this.status < 300;\n    this.statusText = 'statusText' in options ? options.statusText : 'OK';\n    this.headers = new Headers(options.headers);\n    this.url = options.url || '';\n    this._initBody(bodyInit);\n  }\n\n  Body.call(Response.prototype);\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  };\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''});\n    response.type = 'error';\n    return response\n  };\n\n  var redirectStatuses = [301, 302, 303, 307, 308];\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  };\n\n  exports.DOMException = self.DOMException;\n  try {\n    new exports.DOMException();\n  } catch (err) {\n    exports.DOMException = function(message, name) {\n      this.message = message;\n      this.name = name;\n      var error = Error(message);\n      this.stack = error.stack;\n    };\n    exports.DOMException.prototype = Object.create(Error.prototype);\n    exports.DOMException.prototype.constructor = exports.DOMException;\n  }\n\n  function fetch(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init);\n\n      if (request.signal && request.signal.aborted) {\n        return reject(new exports.DOMException('Aborted', 'AbortError'))\n      }\n\n      var xhr = new XMLHttpRequest();\n\n      function abortXhr() {\n        xhr.abort();\n      }\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        };\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL');\n        var body = 'response' in xhr ? xhr.response : xhr.responseText;\n        resolve(new Response(body, options));\n      };\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.onabort = function() {\n        reject(new exports.DOMException('Aborted', 'AbortError'));\n      };\n\n      xhr.open(request.method, request.url, true);\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true;\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false;\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob';\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value);\n      });\n\n      if (request.signal) {\n        request.signal.addEventListener('abort', abortXhr);\n\n        xhr.onreadystatechange = function() {\n          // DONE (success or failure)\n          if (xhr.readyState === 4) {\n            request.signal.removeEventListener('abort', abortXhr);\n          }\n        };\n      }\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit);\n    })\n  }\n\n  fetch.polyfill = true;\n\n  if (!self.fetch) {\n    self.fetch = fetch;\n    self.Headers = Headers;\n    self.Request = Request;\n    self.Response = Response;\n  }\n\n  exports.Headers = Headers;\n  exports.Request = Request;\n  exports.Response = Response;\n  exports.fetch = fetch;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n","import {Constants} from '../../../shared/js/Constants';\nimport PresentationBase from '../../../shared/js/classes/Presentation';\nimport MobileServerBridge from '../../../shared/js/classes/MobileServerBridge';\n\nexport default class Presentation extends PresentationBase{\n\n  constructor(data, role, settings) {\n    super(data, role, settings);\n    this.$overlay = $(`#overlay`);\n  }\n\n  createMobileServerBridge() {\n    return new MobileServerBridge(this, this.settings);\n  }\n\n  handleMobileServerMessage(message) {\n    if(!message.content) {\n      return;\n    }\n    if(message.content.action === `setCurrentSlideIndex`) {\n      this.setCurrentSlideIndex(message.content.currentSlideIndex);\n    } else if(message.content.action === Constants.BLINK) {\n      this.blink(message.content.text, message.content.backgroundColor);\n    }\n  }\n\n  setCurrentSlideIndex(index) {\n    super.setCurrentSlideIndex(index);\n    if(this.$overlay) {\n      this.$overlay.removeClass(`active`);\n    }\n    if(this.blinkInterval) {\n      clearInterval(this.blinkInterval);\n    }\n  }\n\n  blink(text, backgroundColor) {\n    //overlay important, blinking text\n    this.$overlay.find(`.content`).html(text);\n    this.$overlay.addClass(`active`);\n    if(this.blinkInterval) {\n      clearInterval(this.blinkInterval);\n    }\n    this.blinkInterval = setInterval(this.blinkToggle.bind(this, backgroundColor), 500);\n  }\n\n  blinkToggle(backgroundColor) {\n    this.$overlay.toggleClass(`blink-on`);\n    if(this.$overlay.hasClass(`blink-on`)) {\n      this.$overlay.css(`background-color`, backgroundColor);\n    } else {\n      this.$overlay.css(`background-color`, ``);\n    }\n  }\n\n}\n","import Presentation from './classes/Presentation';\nimport fetch from 'isomorphic-fetch';\n\n(() => {\n\n  const init = () => {\n    const settings = {\n      presentationPath: `/`,\n      mobileServerUrl: ``\n    };\n    //get slides by xmlhttprequest\n    fetch(`/data.json?t=${  Date.now()}`)\n      .then(data => data.json())\n      .then(data => {\n        new Presentation(data, `mobile`, settings);\n      });\n  };\n\n  init();\n})();\n","export const Constants = {\n  GO_TO_PREVIOUS_SLIDE: `goToPreviousSlide`,\n  GO_TO_NEXT_SLIDE: `goToNextSlide`,\n  SET_SLIDES: `setSlides`,\n  SET_CURRENT_SLIDE_INDEX: `setCurrentSlideIndex`,\n\n  MESSAGE: `message`,\n  SOCKET_SEND: `socketSend`,\n  SOCKET_RECEIVE: `socketReceive`,\n  JOIN_SLIDE_ROOM: `joinSlideRoom`,\n  LEAVE_SLIDE_ROOM: `leaveSlideRoom`,\n\n  ROLE_PRESENTATION: `presentation`,\n  ROLE_MOBILE: `mobile`,\n\n  STATE_ACTIVE: `active`,\n  STATE_INACTIVE: `inactive`,\n\n  SET_SUBSTATE: `setSubstate`,\n\n  CHILD_APP_SAVE_CODE: `childAppSaveCode`,\n  CHILD_APP_RUN_CODE: `childAppRunCode`,\n  CHILD_APP_STDOUT_DATA: `childAppStdoutData`,\n  CHILD_APP_STDERR_DATA: `childAppStderrData`,\n\n  OPEN_COMMAND_LINE: `openCommandLine`,\n  OPEN_CAMERA: `openCamera`,\n\n  BLINK: `blink`,\n\n  HEART_RATE_POLAR: `heartRatePolar`,\n\n  SET_TEAM: `setTeam`,\n  UPDATE_MOTION: `updateMotion`,\n\n  YOU_WIN: `youWin`,\n  YOU_LOSE: `youLose`,\n\n  SHAKE_YOUR_PHONES_INTRO: `shakeYourPhonesIntro`,\n  SHAKE_YOUR_PHONES_GAME: `shakeYourPhonesGame`,\n  SHAKE_YOUR_PHONES_FINISHED: `shakeYourPhonesFinished`,\n\n  SHAKE_YOUR_PHONES_CLIENT_ADDED: `shakeYourPhonesClientAdded`,\n  SHAKE_YOUR_PHONES_CLIENT_REMOVED: `shakeYourPhonesClientRemoved`,\n  SHAKE_YOUR_PHONES_CLIENT_LIST: `shakeYourPhonesClientList`,\n  SHAKE_YOUR_PHONES_CLIENT_UPDATE: `shakeYourPhonesClientUpdate`\n};\n","import fetch from 'isomorphic-fetch';\n\nexport default class MobileServerBridge {\n\n  constructor(presentation, settings) {\n    this.presentation = presentation;\n    this.settings = settings;\n    this.connect();\n  }\n\n  connect() {\n    if (!this.settings.mobileServerUrl) {\n      return;\n    }\n    console.log(`MobileServerBridge.connect`);\n    //console.warn('MobileServerBridge disabled');\n    //return;\n    //post to the api\n    fetch(`${this.settings.mobileServerUrl}/login`, {\n      method: `POST`,\n      body: JSON.stringify(this.getLoginCredentials()),\n      headers: new Headers({'Content-Type': `application/json`})\n    })\n    .then(response => response.json())\n    .then(result => this.loginHandler(result))\n    .catch(() => {\n      //retry after one second\n      setTimeout(() => this.connect(), 1000);\n    });\n  }\n\n  getLoginCredentials() {\n    return {\n      email: this.settings.mobileServerUsername,\n      password: this.settings.mobileServerPassword,\n    };\n  }\n\n  loginHandler(result) {\n    this.token = result.token;\n    this.socket = io(this.settings.mobileServerUrl, {\n      query: `token=${  this.token}`,\n      reconnection: false,\n      forceNew: true\n    });\n    this.socket.on(`connect`, this.socketConnectHandler.bind(this));\n    this.socket.on(`disconnect`, this.socketDisconnectHandler.bind(this));\n    this.socket.on(`message`, this.socketMessageHandler.bind(this));\n  }\n\n  socketConnectHandler() {\n    console.log(`MobileServerBridge.socketConnectHandler`);\n    this.presentation.mobileServerBridgeConnected();\n  }\n\n  socketDisconnectHandler() {\n    this.connect();\n  }\n\n  tryToSend() {\n    if(this.socket) {\n      this.socket.emit.apply(this.socket, arguments);\n    }\n  }\n\n  socketMessageHandler(message) {\n    this.presentation.mobileServerMessageHandler(message);\n  }\n}\n","import {Constants} from '../Constants';\nimport SlideBridge from './SlideBridge';\n\nexport default class Presentation {\n  /*\n   * data: json object with slides array property\n   * role: mobile or presentation\n   */\n  constructor(data, role, settings) {\n    this.data = data;\n    this.role = role;\n    this.settings = settings;\n    $(`#presentation`).attr(`data-presentation-settings`, JSON.stringify(settings));\n    this.currentSlideIndex = -1;\n    this.slideHolders = [];\n    this.numSlideHolders = 3;\n    this.slideBridges = [];\n    this.slideBridgesBySlideName = {};\n\n    this.createSlideHolders();\n    this.createSlideBridges(this.data);\n\n    this.mobileServerBridge = this.createMobileServerBridge();\n    this.startListeningForMessages();\n\n    this.setCurrentSlideIndex(0);\n  }\n\n  startListeningForMessages() {\n    window.addEventListener(`message`, this.slideMessageHandler.bind(this), false);\n  }\n\n  createSlideHolders() {\n    for(let i = 0; i < this.numSlideHolders; i++) {\n      const $slideHolder = $(`<div class=\"slide-frame\" />`);\n      this.slideHolders.push($slideHolder);\n      $(`#presentation`).append($slideHolder);\n    }\n  }\n\n  createSlideBridges(data) {\n    const numSlides = data.slides.length;\n    for(let i = 0; i < numSlides; i++) {\n      const slideBridge = this.createSlideBridge(data.slides[i]);\n      this.slideBridges.push(slideBridge);\n      this.slideBridgesBySlideName[slideBridge.name] = slideBridge;\n    }\n  }\n\n  createSlideBridge(slide) {\n    return new SlideBridge(slide);\n  }\n\n  slideMessageHandler(event) {\n    if(!event.data) {\n      return;\n    }\n    switch(event.data.action) {\n    case Constants.SOCKET_SEND:\n      if(this.mobileServerBridge) {\n        this.mobileServerBridge.tryToSend(Constants.MESSAGE, event.data.message);\n      }\n      break;\n    }\n  }\n\n  mobileServerBridgeConnected() {\n    //join the rooms of the slideHolders\n    for(let i = 0; i < this.numSlideHolders; i++) {\n      this.mobileServerBridge.tryToSend(Constants.JOIN_SLIDE_ROOM, $(this.slideHolders[i]).attr(`data-name`));\n    }\n  }\n\n  mobileServerMessageHandler(message) {\n    if(message.target.slide) {\n      //slide has to handle the message\n      const slideBridge = this.getSlideBridgeByName(message.target.slide);\n      if(slideBridge) {\n        slideBridge.tryToPostMessage({\n          action: Constants.SOCKET_RECEIVE,\n          message: message\n        });\n      }\n    } else {\n      //presentation has to handle the message\n      this.handleMobileServerMessage(message);\n    }\n  }\n\n  handleMobileServerMessage(message) {\n    console.log(`[shared/Presentation] handleMobileServerMessage`, message);\n  }\n\n  getSlideBridgeByIndex(index) {\n    if(index >= 0 && index < this.slideBridges.length) {\n      return this.slideBridges[index];\n    }\n    return false;\n  }\n\n  getSlideBridgeByName(slideName) {\n    return this.slideBridgesBySlideName[slideName];\n  }\n\n  getSlideHolderForSlide(slide, slidesNotToClear) {\n    if(slide) {\n      let $slideHolder = $(`.slide-frame[data-name=\"${  slide.name  }\"]`);\n      if($slideHolder.length > 0) {\n        return $slideHolder[0];\n      }\n      //get a free slideHolder\n      const slideNamesNotToClear = [];\n      $(slidesNotToClear).each(function(index, obj){\n        slideNamesNotToClear.push(obj.name);\n      });\n      const $slideHolders = $(`.slide-frame`);\n      for (let i = $slideHolders.length - 1; i >= 0; i--) {\n        $slideHolder = $($slideHolders[i]);\n        const name = $slideHolder.attr(`data-name`);\n        if(!name || slideNamesNotToClear.indexOf(name) === -1) {\n          return $slideHolder[0];\n        }\n      }\n    }\n    return false;\n  }\n\n  goToPreviousSlide() {\n    this.setCurrentSlideIndex(this.currentSlideIndex - 1);\n  }\n\n  goToNextSlide() {\n    this.setCurrentSlideIndex(this.currentSlideIndex + 1);\n  }\n\n  setCurrentSlideIndex(value) {\n    value = Math.max(0, Math.min(value, this.slideBridges.length - 1));\n    if(value !== this.currentSlideIndex) {\n      this.currentSlideIndex = value;\n\n      const currentSlideBridge = this.getSlideBridgeByIndex(this.currentSlideIndex);\n      const previousSlideBridge = this.getSlideBridgeByIndex(this.currentSlideIndex - 1);\n      const nextSlideBridge = this.getSlideBridgeByIndex(this.currentSlideIndex + 1);\n\n      //remove \"used\" class from slide holders\n      $(`.slide-frame`).removeAttr(`data-used`, false);\n\n      const currentSlideHolder = this.getSlideHolderForSlide(currentSlideBridge, [previousSlideBridge, nextSlideBridge]);\n      this.setupSlideHolder(currentSlideHolder, currentSlideBridge, Constants.STATE_ACTIVE, 0);\n\n      const previousSlideHolder = this.getSlideHolderForSlide(previousSlideBridge, [currentSlideBridge, nextSlideBridge]);\n      this.setupSlideHolder(previousSlideHolder, previousSlideBridge, Constants.STATE_INACTIVE, `-100%`);\n\n      const nextSlideHolder = this.getSlideHolderForSlide(nextSlideBridge, [previousSlideBridge, currentSlideBridge]);\n      this.setupSlideHolder(nextSlideHolder, nextSlideBridge, Constants.STATE_INACTIVE, `100%`);\n\n      //clear attributes of unused slide frames\n      $(`.slide-frame`).each(function(index, slideHolder){\n        if(!$(slideHolder).attr(`data-used`)) {\n          $(slideHolder).removeAttr(`data-used`).removeAttr(`data-name`).removeAttr(`data-src`);\n        }\n      });\n\n      //all other slideHolder bridges should be unlinked from their slideHolder\n      this.slideBridges.forEach(function(slideBridge){\n        if(slideBridge === currentSlideBridge) {\n          return;\n        }\n        if(slideBridge === previousSlideBridge) {\n          return;\n        }\n        if(slideBridge === nextSlideBridge) {\n          return;\n        }\n        slideBridge.slideHolder = null;\n      });\n\n      bean.fire(this, Constants.SET_CURRENT_SLIDE_INDEX, [this.currentSlideIndex]);\n    }\n  }\n\n  setupSlideHolder(slideHolder, slideBridge, state, left) {\n    if(slideHolder) {\n      let src = `slides/${  slideBridge.name  }.html`;\n      if(slideBridge.data[this.role] && slideBridge.data[this.role].url) {\n        src = slideBridge.data[this.role].url;\n      }\n      src = this.processSlideSrc(src);\n      if(slideBridge.isAlreadyCorrectlyAttached(slideHolder, src)) {\n        //console.log(slideBridge.name + ' already attached');\n      } else {\n        this.attachToSlideHolder(slideHolder, slideBridge, src);\n      }\n      slideBridge.setState(state);\n      $(slideHolder).css(`left`, left);\n      $(slideHolder).attr(`data-used`, 1);\n    }\n  }\n\n  attachToSlideHolder(slideHolder, slideBridge, src) {\n    //listen for events on this slideHolder\n    $(slideHolder).off(`message-from-slide`);\n    $(slideHolder).on(`message-from-slide`, (event, message) =>  {\n      this.slideMessageHandler({data: message});\n    });\n    //leave previous channel of this slideHolder\n    if(this.mobileServerBridge) {\n      this.mobileServerBridge.tryToSend(Constants.LEAVE_SLIDE_ROOM, $(slideHolder).attr(`data-name`));\n    }\n    //add the join as a callback for the onload event\n    slideBridge.attachToSlideHolder(slideHolder, src, this.slideLoaded.bind(this, slideHolder, slideBridge, src));\n  }\n\n  slideLoaded(slideHolder, slideBridge) { // eslint-disable-line no-unused-vars\n    //join new channel\n    if(this.mobileServerBridge) {\n      this.mobileServerBridge.tryToSend(Constants.JOIN_SLIDE_ROOM, $(slideHolder).attr(`data-name`));\n    }\n  }\n\n  processSlideSrc(src) {\n    return src;\n  }\n\n  createMobileServerBridge() {\n    //to implement in extending classes\n  }\n}\n","import fetch from 'isomorphic-fetch';\n\nexport default class SlideBridge {\n  constructor(data) {\n    this.data = data;\n    this.name = this.data.name;\n  }\n\n  isAlreadyCorrectlyAttached(slideHolder, src) {\n    return (this.slideHolder === slideHolder && $(slideHolder).attr(`data-name`) === this.name && $(slideHolder).attr(`data-src`) === src);\n  }\n\n  attachToSlideHolder(slideHolder, src, cb) {\n    this.slideHolder = slideHolder;\n    //notify the content it is being cleared\n    this.tryToPostMessage({action: `destroy`});\n    //clear the current content\n    this.slideHolder.innerHTML = ``;\n    $(slideHolder).attr(`data-name`, this.name);\n    $(slideHolder).addClass(`loading`);\n\n    $(slideHolder).off(`load`);\n    $(slideHolder).on(`load`, () => {\n      this.tryToPostMessage({\n        action: `setState`,\n        state: this.state\n      });\n      $(slideHolder).off(`load`);\n    });\n\n    if(src !== $(slideHolder).attr(`data-src`)) {\n      //fetch the html\n      fetch(src)\n        .then(result => result.text())\n        .then(result => $(result))\n        .then($result => {\n          $(slideHolder).html($result.html());\n          $(slideHolder).removeClass(`loading`);\n          cb();\n        })\n        .catch(err => {\n          console.error(err);\n          $(slideHolder).removeClass(`loading`);\n          cb();\n        });\n      $(slideHolder).attr(`data-src`, src);\n    }\n  }\n\n  tryToPostMessage(message) {\n    if(!this.slideHolder)\n    {\n      console.log(`${this.name  } post fail`);\n      return;\n    }\n    //trigger with jquery\n    $(this.slideHolder).trigger(`message-to-slide`, message);\n  }\n\n  setState(state) {\n    this.state = state;\n    this.tryToPostMessage({\n      action: `setState`,\n      state: this.state\n    });\n  }\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvaXNvbW9ycGhpYy1mZXRjaC9mZXRjaC1ucG0tYnJvd3NlcmlmeS5qcyIsIm5vZGVfbW9kdWxlcy93aGF0d2ctZmV0Y2gvZGlzdC9mZXRjaC51bWQuanMiLCJzcmMvbW9iaWxlL2pzL2NsYXNzZXMvUHJlc2VudGF0aW9uLmpzIiwic3JjL21vYmlsZS9qcy9zY3JpcHQuanMiLCJzcmMvc2hhcmVkL2pzL0NvbnN0YW50cy5qcyIsInNyYy9zaGFyZWQvanMvY2xhc3Nlcy9Nb2JpbGVTZXJ2ZXJCcmlkZ2UuanMiLCJzcmMvc2hhcmVkL2pzL2NsYXNzZXMvUHJlc2VudGF0aW9uLmpzIiwic3JjL3NoYXJlZC9qcy9jbGFzc2VzL1NsaWRlQnJpZGdlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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LFNBUEgsRUFRRyxLQVJILENBUVMsZUFBTztBQUNaLGtCQUFRLEtBQVIsQ0FBYyxHQUFkO0FBQ0EsWUFBRSxXQUFGLEVBQWUsV0FBZjtBQUNBO0FBQ0QsU0FaSDtBQWFBLFVBQUUsV0FBRixFQUFlLElBQWYsYUFBZ0MsR0FBaEM7QUFDRDtBQUNGOzs7cUNBRWdCLE8sRUFBUztBQUN4QixVQUFHLENBQUMsS0FBSyxXQUFULEVBQ0E7QUFDRSxnQkFBUSxHQUFSLENBQWUsS0FBSyxJQUFwQjtBQUNBO0FBQ0Q7QUFDRDtBQUNBLFFBQUUsS0FBSyxXQUFQLEVBQW9CLE9BQXBCLHFCQUFnRCxPQUFoRDtBQUNEOzs7NkJBRVEsSyxFQUFPO0FBQ2QsV0FBSyxLQUFMLEdBQWEsS0FBYjtBQUNBLFdBQUssZ0JBQUwsQ0FBc0I7QUFDcEIsMEJBRG9CO0FBRXBCLGVBQU8sS0FBSztBQUZRLE9BQXRCO0FBSUQ7Ozs7OztrQkEvRGtCLFciLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvLyB0aGUgd2hhdHdnLWZldGNoIHBvbHlmaWxsIGluc3RhbGxzIHRoZSBmZXRjaCgpIGZ1bmN0aW9uXG4vLyBvbiB0aGUgZ2xvYmFsIG9iamVjdCAod2luZG93IG9yIHNlbGYpXG4vL1xuLy8gUmV0dXJuIHRoYXQgYXMgdGhlIGV4cG9ydCBmb3IgdXNlIGluIFdlYnBhY2ssIEJyb3dzZXJpZnkgZXRjLlxucmVxdWlyZSgnd2hhdHdnLWZldGNoJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHNlbGYuZmV0Y2guYmluZChzZWxmKTtcbiIsIihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG4gIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IGZhY3RvcnkoZXhwb3J0cykgOlxuICB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoWydleHBvcnRzJ10sIGZhY3RvcnkpIDpcbiAgKGZhY3RvcnkoKGdsb2JhbC5XSEFUV0dGZXRjaCA9IHt9KSkpO1xufSh0aGlzLCAoZnVuY3Rpb24gKGV4cG9ydHMpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gIHZhciBzdXBwb3J0ID0ge1xuICAgIHNlYXJjaFBhcmFtczogJ1VSTFNlYXJjaFBhcmFtcycgaW4gc2VsZixcbiAgICBpdGVyYWJsZTogJ1N5bWJvbCcgaW4gc2VsZiAmJiAnaXRlcmF0b3InIGluIFN5bWJvbCxcbiAgICBibG9iOlxuICAgICAgJ0ZpbGVSZWFkZXInIGluIHNlbGYgJiZcbiAgICAgICdCbG9iJyBpbiBzZWxmICYmXG4gICAgICAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgbmV3IEJsb2IoKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0pKCksXG4gICAgZm9ybURhdGE6ICdGb3JtRGF0YScgaW4gc2VsZixcbiAgICBhcnJheUJ1ZmZlcjogJ0FycmF5QnVmZmVyJyBpbiBzZWxmXG4gIH07XG5cbiAgZnVuY3Rpb24gaXNEYXRhVmlldyhvYmopIHtcbiAgICByZXR1cm4gb2JqICYmIERhdGFWaWV3LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKG9iailcbiAgfVxuXG4gIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyKSB7XG4gICAgdmFyIHZpZXdDbGFzc2VzID0gW1xuICAgICAgJ1tvYmplY3QgSW50OEFycmF5XScsXG4gICAgICAnW29iamVjdCBVaW50OEFycmF5XScsXG4gICAgICAnW29iamVjdCBVaW50OENsYW1wZWRBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgSW50MTZBcnJheV0nLFxuICAgICAgJ1tvYmplY3QgVWludDE2QXJyYXldJyxcbiAgICAgICdbb2JqZWN0IEludDMyQXJyYXldJyxcbiAgICAgICdbb2JqZWN0IFVpbnQzMkFycmF5XScsXG4gICAgICAnW29iamVjdCBGbG9hdDMyQXJyYXldJyxcbiAgICAgICdbb2JqZWN0IEZsb2F0NjRBcnJheV0nXG4gICAgXTtcblxuICAgIHZhciBpc0FycmF5QnVmZmVyVmlldyA9XG4gICAgICBBcnJheUJ1ZmZlci5pc1ZpZXcgfHxcbiAgICAgIGZ1bmN0aW9uKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqICYmIHZpZXdDbGFzc2VzLmluZGV4T2YoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikpID4gLTFcbiAgICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBub3JtYWxpemVOYW1lKG5hbWUpIHtcbiAgICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICBuYW1lID0gU3RyaW5nKG5hbWUpO1xuICAgIH1cbiAgICBpZiAoL1teYS16MC05XFwtIyQlJicqKy5eX2B8fl0vaS50ZXN0KG5hbWUpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGNoYXJhY3RlciBpbiBoZWFkZXIgZmllbGQgbmFtZScpXG4gICAgfVxuICAgIHJldHVybiBuYW1lLnRvTG93ZXJDYXNlKClcbiAgfVxuXG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZVZhbHVlKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHZhbHVlID0gU3RyaW5nKHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlXG4gIH1cblxuICAvLyBCdWlsZCBhIGRlc3RydWN0aXZlIGl0ZXJhdG9yIGZvciB0aGUgdmFsdWUgbGlzdFxuICBmdW5jdGlvbiBpdGVyYXRvckZvcihpdGVtcykge1xuICAgIHZhciBpdGVyYXRvciA9IHtcbiAgICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBpdGVtcy5zaGlmdCgpO1xuICAgICAgICByZXR1cm4ge2RvbmU6IHZhbHVlID09PSB1bmRlZmluZWQsIHZhbHVlOiB2YWx1ZX1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKHN1cHBvcnQuaXRlcmFibGUpIHtcbiAgICAgIGl0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhdG9yXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiBpdGVyYXRvclxuICB9XG5cbiAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gICAgdGhpcy5tYXAgPSB7fTtcblxuICAgIGlmIChoZWFkZXJzIGluc3RhbmNlb2YgSGVhZGVycykge1xuICAgICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICAgIHRoaXMuYXBwZW5kKG5hbWUsIHZhbHVlKTtcbiAgICAgIH0sIHRoaXMpO1xuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShoZWFkZXJzKSkge1xuICAgICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKGhlYWRlcikge1xuICAgICAgICB0aGlzLmFwcGVuZChoZWFkZXJbMF0sIGhlYWRlclsxXSk7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9IGVsc2UgaWYgKGhlYWRlcnMpIHtcbiAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGhlYWRlcnMpLmZvckVhY2goZnVuY3Rpb24obmFtZSkge1xuICAgICAgICB0aGlzLmFwcGVuZChuYW1lLCBoZWFkZXJzW25hbWVdKTtcbiAgICAgIH0sIHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gICAgbmFtZSA9IG5vcm1hbGl6ZU5hbWUobmFtZSk7XG4gICAgdmFsdWUgPSBub3JtYWxpemVWYWx1ZSh2YWx1ZSk7XG4gICAgdmFyIG9sZFZhbHVlID0gdGhpcy5tYXBbbmFtZV07XG4gICAgdGhpcy5tYXBbbmFtZV0gPSBvbGRWYWx1ZSA/IG9sZFZhbHVlICsgJywgJyArIHZhbHVlIDogdmFsdWU7XG4gIH07XG5cbiAgSGVhZGVycy5wcm90b3R5cGVbJ2RlbGV0ZSddID0gZnVuY3Rpb24obmFtZSkge1xuICAgIGRlbGV0ZSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXTtcbiAgfTtcblxuICBIZWFkZXJzLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgbmFtZSA9IG5vcm1hbGl6ZU5hbWUobmFtZSk7XG4gICAgcmV0dXJuIHRoaXMuaGFzKG5hbWUpID8gdGhpcy5tYXBbbmFtZV0gOiBudWxsXG4gIH07XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24obmFtZSkge1xuICAgIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxuICB9O1xuXG4gIEhlYWRlcnMucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gICAgdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV0gPSBub3JtYWxpemVWYWx1ZSh2YWx1ZSk7XG4gIH07XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzLm1hcCkge1xuICAgICAgaWYgKHRoaXMubWFwLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpcy5tYXBbbmFtZV0sIG5hbWUsIHRoaXMpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBIZWFkZXJzLnByb3RvdHlwZS5rZXlzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGl0ZW1zID0gW107XG4gICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICBpdGVtcy5wdXNoKG5hbWUpO1xuICAgIH0pO1xuICAgIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbiAgfTtcblxuICBIZWFkZXJzLnByb3RvdHlwZS52YWx1ZXMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXRlbXMgPSBbXTtcbiAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIGl0ZW1zLnB1c2godmFsdWUpO1xuICAgIH0pO1xuICAgIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbiAgfTtcblxuICBIZWFkZXJzLnByb3RvdHlwZS5lbnRyaWVzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGl0ZW1zID0gW107XG4gICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICBpdGVtcy5wdXNoKFtuYW1lLCB2YWx1ZV0pO1xuICAgIH0pO1xuICAgIHJldHVybiBpdGVyYXRvckZvcihpdGVtcylcbiAgfTtcblxuICBpZiAoc3VwcG9ydC5pdGVyYWJsZSkge1xuICAgIEhlYWRlcnMucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl0gPSBIZWFkZXJzLnByb3RvdHlwZS5lbnRyaWVzO1xuICB9XG5cbiAgZnVuY3Rpb24gY29uc3VtZWQoYm9keSkge1xuICAgIGlmIChib2R5LmJvZHlVc2VkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJykpXG4gICAgfVxuICAgIGJvZHkuYm9keVVzZWQgPSB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gZmlsZVJlYWRlclJlYWR5KHJlYWRlcikge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzb2x2ZShyZWFkZXIucmVzdWx0KTtcbiAgICAgIH07XG4gICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QocmVhZGVyLmVycm9yKTtcbiAgICAgIH07XG4gICAgfSlcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYWRCbG9iQXNBcnJheUJ1ZmZlcihibG9iKSB7XG4gICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgdmFyIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKTtcbiAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoYmxvYik7XG4gICAgcmV0dXJuIHByb21pc2VcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYWRCbG9iQXNUZXh0KGJsb2IpIHtcbiAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICB2YXIgcHJvbWlzZSA9IGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpO1xuICAgIHJlYWRlci5yZWFkQXNUZXh0KGJsb2IpO1xuICAgIHJldHVybiBwcm9taXNlXG4gIH1cblxuICBmdW5jdGlvbiByZWFkQXJyYXlCdWZmZXJBc1RleHQoYnVmKSB7XG4gICAgdmFyIHZpZXcgPSBuZXcgVWludDhBcnJheShidWYpO1xuICAgIHZhciBjaGFycyA9IG5ldyBBcnJheSh2aWV3Lmxlbmd0aCk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZpZXcubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNoYXJzW2ldID0gU3RyaW5nLmZyb21DaGFyQ29kZSh2aWV3W2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNoYXJzLmpvaW4oJycpXG4gIH1cblxuICBmdW5jdGlvbiBidWZmZXJDbG9uZShidWYpIHtcbiAgICBpZiAoYnVmLnNsaWNlKSB7XG4gICAgICByZXR1cm4gYnVmLnNsaWNlKDApXG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmLmJ5dGVMZW5ndGgpO1xuICAgICAgdmlldy5zZXQobmV3IFVpbnQ4QXJyYXkoYnVmKSk7XG4gICAgICByZXR1cm4gdmlldy5idWZmZXJcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBCb2R5KCkge1xuICAgIHRoaXMuYm9keVVzZWQgPSBmYWxzZTtcblxuICAgIHRoaXMuX2luaXRCb2R5ID0gZnVuY3Rpb24oYm9keSkge1xuICAgICAgdGhpcy5fYm9keUluaXQgPSBib2R5O1xuICAgICAgaWYgKCFib2R5KSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gJyc7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykge1xuICAgICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHk7XG4gICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYmxvYiAmJiBCbG9iLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICAgIHRoaXMuX2JvZHlCbG9iID0gYm9keTtcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5mb3JtRGF0YSAmJiBGb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5Rm9ybURhdGEgPSBib2R5O1xuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LnNlYXJjaFBhcmFtcyAmJiBVUkxTZWFyY2hQYXJhbXMucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkpIHtcbiAgICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5LnRvU3RyaW5nKCk7XG4gICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYXJyYXlCdWZmZXIgJiYgc3VwcG9ydC5ibG9iICYmIGlzRGF0YVZpZXcoYm9keSkpIHtcbiAgICAgICAgdGhpcy5fYm9keUFycmF5QnVmZmVyID0gYnVmZmVyQ2xvbmUoYm9keS5idWZmZXIpO1xuICAgICAgICAvLyBJRSAxMC0xMSBjYW4ndCBoYW5kbGUgYSBEYXRhVmlldyBib2R5LlxuICAgICAgICB0aGlzLl9ib2R5SW5pdCA9IG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKTtcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5hcnJheUJ1ZmZlciAmJiAoQXJyYXlCdWZmZXIucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkgfHwgaXNBcnJheUJ1ZmZlclZpZXcoYm9keSkpKSB7XG4gICAgICAgIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA9IGJ1ZmZlckNsb25lKGJvZHkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5ID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGJvZHkpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXMuaGVhZGVycy5nZXQoJ2NvbnRlbnQtdHlwZScpKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYm9keSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICB0aGlzLmhlYWRlcnMuc2V0KCdjb250ZW50LXR5cGUnLCAndGV4dC9wbGFpbjtjaGFyc2V0PVVURi04Jyk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUJsb2IgJiYgdGhpcy5fYm9keUJsb2IudHlwZSkge1xuICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsIHRoaXMuX2JvZHlCbG9iLnR5cGUpO1xuICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCcpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmIChzdXBwb3J0LmJsb2IpIHtcbiAgICAgIHRoaXMuYmxvYiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcmVqZWN0ZWQgPSBjb25zdW1lZCh0aGlzKTtcbiAgICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fYm9keUJsb2IpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlCbG9iKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlBcnJheUJ1ZmZlcl0pKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyBibG9iJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5VGV4dF0pKVxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB0aGlzLmFycmF5QnVmZmVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICByZXR1cm4gY29uc3VtZWQodGhpcykgfHwgUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcilcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5ibG9iKCkudGhlbihyZWFkQmxvYkFzQXJyYXlCdWZmZXIpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuXG4gICAgdGhpcy50ZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcmVqZWN0ZWQgPSBjb25zdW1lZCh0aGlzKTtcbiAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgIHJldHVybiByZWFkQmxvYkFzVGV4dCh0aGlzLl9ib2R5QmxvYilcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVhZEFycmF5QnVmZmVyQXNUZXh0KHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgdGV4dCcpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KVxuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAoc3VwcG9ydC5mb3JtRGF0YSkge1xuICAgICAgdGhpcy5mb3JtRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihkZWNvZGUpXG4gICAgICB9O1xuICAgIH1cblxuICAgIHRoaXMuanNvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMudGV4dCgpLnRoZW4oSlNPTi5wYXJzZSlcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8vIEhUVFAgbWV0aG9kcyB3aG9zZSBjYXBpdGFsaXphdGlvbiBzaG91bGQgYmUgbm9ybWFsaXplZFxuICB2YXIgbWV0aG9kcyA9IFsnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUE9TVCcsICdQVVQnXTtcblxuICBmdW5jdGlvbiBub3JtYWxpemVNZXRob2QobWV0aG9kKSB7XG4gICAgdmFyIHVwY2FzZWQgPSBtZXRob2QudG9VcHBlckNhc2UoKTtcbiAgICByZXR1cm4gbWV0aG9kcy5pbmRleE9mKHVwY2FzZWQpID4gLTEgPyB1cGNhc2VkIDogbWV0aG9kXG4gIH1cblxuICBmdW5jdGlvbiBSZXF1ZXN0KGlucHV0LCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgdmFyIGJvZHkgPSBvcHRpb25zLmJvZHk7XG5cbiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBSZXF1ZXN0KSB7XG4gICAgICBpZiAoaW5wdXQuYm9keVVzZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJylcbiAgICAgIH1cbiAgICAgIHRoaXMudXJsID0gaW5wdXQudXJsO1xuICAgICAgdGhpcy5jcmVkZW50aWFscyA9IGlucHV0LmNyZWRlbnRpYWxzO1xuICAgICAgaWYgKCFvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMoaW5wdXQuaGVhZGVycyk7XG4gICAgICB9XG4gICAgICB0aGlzLm1ldGhvZCA9IGlucHV0Lm1ldGhvZDtcbiAgICAgIHRoaXMubW9kZSA9IGlucHV0Lm1vZGU7XG4gICAgICB0aGlzLnNpZ25hbCA9IGlucHV0LnNpZ25hbDtcbiAgICAgIGlmICghYm9keSAmJiBpbnB1dC5fYm9keUluaXQgIT0gbnVsbCkge1xuICAgICAgICBib2R5ID0gaW5wdXQuX2JvZHlJbml0O1xuICAgICAgICBpbnB1dC5ib2R5VXNlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudXJsID0gU3RyaW5nKGlucHV0KTtcbiAgICB9XG5cbiAgICB0aGlzLmNyZWRlbnRpYWxzID0gb3B0aW9ucy5jcmVkZW50aWFscyB8fCB0aGlzLmNyZWRlbnRpYWxzIHx8ICdzYW1lLW9yaWdpbic7XG4gICAgaWYgKG9wdGlvbnMuaGVhZGVycyB8fCAhdGhpcy5oZWFkZXJzKSB7XG4gICAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpO1xuICAgIH1cbiAgICB0aGlzLm1ldGhvZCA9IG5vcm1hbGl6ZU1ldGhvZChvcHRpb25zLm1ldGhvZCB8fCB0aGlzLm1ldGhvZCB8fCAnR0VUJyk7XG4gICAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlIHx8IHRoaXMubW9kZSB8fCBudWxsO1xuICAgIHRoaXMuc2lnbmFsID0gb3B0aW9ucy5zaWduYWwgfHwgdGhpcy5zaWduYWw7XG4gICAgdGhpcy5yZWZlcnJlciA9IG51bGw7XG5cbiAgICBpZiAoKHRoaXMubWV0aG9kID09PSAnR0VUJyB8fCB0aGlzLm1ldGhvZCA9PT0gJ0hFQUQnKSAmJiBib2R5KSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdCb2R5IG5vdCBhbGxvd2VkIGZvciBHRVQgb3IgSEVBRCByZXF1ZXN0cycpXG4gICAgfVxuICAgIHRoaXMuX2luaXRCb2R5KGJvZHkpO1xuICB9XG5cbiAgUmVxdWVzdC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFJlcXVlc3QodGhpcywge2JvZHk6IHRoaXMuX2JvZHlJbml0fSlcbiAgfTtcblxuICBmdW5jdGlvbiBkZWNvZGUoYm9keSkge1xuICAgIHZhciBmb3JtID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgYm9keVxuICAgICAgLnRyaW0oKVxuICAgICAgLnNwbGl0KCcmJylcbiAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGVzKSB7XG4gICAgICAgIGlmIChieXRlcykge1xuICAgICAgICAgIHZhciBzcGxpdCA9IGJ5dGVzLnNwbGl0KCc9Jyk7XG4gICAgICAgICAgdmFyIG5hbWUgPSBzcGxpdC5zaGlmdCgpLnJlcGxhY2UoL1xcKy9nLCAnICcpO1xuICAgICAgICAgIHZhciB2YWx1ZSA9IHNwbGl0LmpvaW4oJz0nKS5yZXBsYWNlKC9cXCsvZywgJyAnKTtcbiAgICAgICAgICBmb3JtLmFwcGVuZChkZWNvZGVVUklDb21wb25lbnQobmFtZSksIGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICByZXR1cm4gZm9ybVxuICB9XG5cbiAgZnVuY3Rpb24gcGFyc2VIZWFkZXJzKHJhd0hlYWRlcnMpIHtcbiAgICB2YXIgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgLy8gUmVwbGFjZSBpbnN0YW5jZXMgb2YgXFxyXFxuIGFuZCBcXG4gZm9sbG93ZWQgYnkgYXQgbGVhc3Qgb25lIHNwYWNlIG9yIGhvcml6b250YWwgdGFiIHdpdGggYSBzcGFjZVxuICAgIC8vIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM3MjMwI3NlY3Rpb24tMy4yXG4gICAgdmFyIHByZVByb2Nlc3NlZEhlYWRlcnMgPSByYXdIZWFkZXJzLnJlcGxhY2UoL1xccj9cXG5bXFx0IF0rL2csICcgJyk7XG4gICAgcHJlUHJvY2Vzc2VkSGVhZGVycy5zcGxpdCgvXFxyP1xcbi8pLmZvckVhY2goZnVuY3Rpb24obGluZSkge1xuICAgICAgdmFyIHBhcnRzID0gbGluZS5zcGxpdCgnOicpO1xuICAgICAgdmFyIGtleSA9IHBhcnRzLnNoaWZ0KCkudHJpbSgpO1xuICAgICAgaWYgKGtleSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBwYXJ0cy5qb2luKCc6JykudHJpbSgpO1xuICAgICAgICBoZWFkZXJzLmFwcGVuZChrZXksIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gaGVhZGVyc1xuICB9XG5cbiAgQm9keS5jYWxsKFJlcXVlc3QucHJvdG90eXBlKTtcblxuICBmdW5jdGlvbiBSZXNwb25zZShib2R5SW5pdCwgb3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgb3B0aW9ucyA9IHt9O1xuICAgIH1cblxuICAgIHRoaXMudHlwZSA9ICdkZWZhdWx0JztcbiAgICB0aGlzLnN0YXR1cyA9IG9wdGlvbnMuc3RhdHVzID09PSB1bmRlZmluZWQgPyAyMDAgOiBvcHRpb25zLnN0YXR1cztcbiAgICB0aGlzLm9rID0gdGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwO1xuICAgIHRoaXMuc3RhdHVzVGV4dCA9ICdzdGF0dXNUZXh0JyBpbiBvcHRpb25zID8gb3B0aW9ucy5zdGF0dXNUZXh0IDogJ09LJztcbiAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpO1xuICAgIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJyc7XG4gICAgdGhpcy5faW5pdEJvZHkoYm9keUluaXQpO1xuICB9XG5cbiAgQm9keS5jYWxsKFJlc3BvbnNlLnByb3RvdHlwZSk7XG5cbiAgUmVzcG9uc2UucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZSh0aGlzLl9ib2R5SW5pdCwge1xuICAgICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcbiAgICAgIHN0YXR1c1RleHQ6IHRoaXMuc3RhdHVzVGV4dCxcbiAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHRoaXMuaGVhZGVycyksXG4gICAgICB1cmw6IHRoaXMudXJsXG4gICAgfSlcbiAgfTtcblxuICBSZXNwb25zZS5lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciByZXNwb25zZSA9IG5ldyBSZXNwb25zZShudWxsLCB7c3RhdHVzOiAwLCBzdGF0dXNUZXh0OiAnJ30pO1xuICAgIHJlc3BvbnNlLnR5cGUgPSAnZXJyb3InO1xuICAgIHJldHVybiByZXNwb25zZVxuICB9O1xuXG4gIHZhciByZWRpcmVjdFN0YXR1c2VzID0gWzMwMSwgMzAyLCAzMDMsIDMwNywgMzA4XTtcblxuICBSZXNwb25zZS5yZWRpcmVjdCA9IGZ1bmN0aW9uKHVybCwgc3RhdHVzKSB7XG4gICAgaWYgKHJlZGlyZWN0U3RhdHVzZXMuaW5kZXhPZihzdGF0dXMpID09PSAtMSkge1xuICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgc3RhdHVzIGNvZGUnKVxuICAgIH1cblxuICAgIHJldHVybiBuZXcgUmVzcG9uc2UobnVsbCwge3N0YXR1czogc3RhdHVzLCBoZWFkZXJzOiB7bG9jYXRpb246IHVybH19KVxuICB9O1xuXG4gIGV4cG9ydHMuRE9NRXhjZXB0aW9uID0gc2VsZi5ET01FeGNlcHRpb247XG4gIHRyeSB7XG4gICAgbmV3IGV4cG9ydHMuRE9NRXhjZXB0aW9uKCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGV4cG9ydHMuRE9NRXhjZXB0aW9uID0gZnVuY3Rpb24obWVzc2FnZSwgbmFtZSkge1xuICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICB2YXIgZXJyb3IgPSBFcnJvcihtZXNzYWdlKTtcbiAgICAgIHRoaXMuc3RhY2sgPSBlcnJvci5zdGFjaztcbiAgICB9O1xuICAgIGV4cG9ydHMuRE9NRXhjZXB0aW9uLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbiAgICBleHBvcnRzLkRPTUV4Y2VwdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBleHBvcnRzLkRPTUV4Y2VwdGlvbjtcbiAgfVxuXG4gIGZ1bmN0aW9uIGZldGNoKGlucHV0LCBpbml0KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgUmVxdWVzdChpbnB1dCwgaW5pdCk7XG5cbiAgICAgIGlmIChyZXF1ZXN0LnNpZ25hbCAmJiByZXF1ZXN0LnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgIHJldHVybiByZWplY3QobmV3IGV4cG9ydHMuRE9NRXhjZXB0aW9uKCdBYm9ydGVkJywgJ0Fib3J0RXJyb3InKSlcbiAgICAgIH1cblxuICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG4gICAgICBmdW5jdGlvbiBhYm9ydFhocigpIHtcbiAgICAgICAgeGhyLmFib3J0KCk7XG4gICAgICB9XG5cbiAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgc3RhdHVzOiB4aHIuc3RhdHVzLFxuICAgICAgICAgIHN0YXR1c1RleHQ6IHhoci5zdGF0dXNUZXh0LFxuICAgICAgICAgIGhlYWRlcnM6IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgfHwgJycpXG4gICAgICAgIH07XG4gICAgICAgIG9wdGlvbnMudXJsID0gJ3Jlc3BvbnNlVVJMJyBpbiB4aHIgPyB4aHIucmVzcG9uc2VVUkwgOiBvcHRpb25zLmhlYWRlcnMuZ2V0KCdYLVJlcXVlc3QtVVJMJyk7XG4gICAgICAgIHZhciBib2R5ID0gJ3Jlc3BvbnNlJyBpbiB4aHIgPyB4aHIucmVzcG9uc2UgOiB4aHIucmVzcG9uc2VUZXh0O1xuICAgICAgICByZXNvbHZlKG5ldyBSZXNwb25zZShib2R5LCBvcHRpb25zKSk7XG4gICAgICB9O1xuXG4gICAgICB4aHIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKTtcbiAgICAgIH07XG5cbiAgICAgIHhoci5vbnRpbWVvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSk7XG4gICAgICB9O1xuXG4gICAgICB4aHIub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QobmV3IGV4cG9ydHMuRE9NRXhjZXB0aW9uKCdBYm9ydGVkJywgJ0Fib3J0RXJyb3InKSk7XG4gICAgICB9O1xuXG4gICAgICB4aHIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgcmVxdWVzdC51cmwsIHRydWUpO1xuXG4gICAgICBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ2luY2x1ZGUnKSB7XG4gICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICAgICAgfSBlbHNlIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnb21pdCcpIHtcbiAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBpZiAoJ3Jlc3BvbnNlVHlwZScgaW4geGhyICYmIHN1cHBvcnQuYmxvYikge1xuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InO1xuICAgICAgfVxuXG4gICAgICByZXF1ZXN0LmhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihuYW1lLCB2YWx1ZSk7XG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlcXVlc3Quc2lnbmFsKSB7XG4gICAgICAgIHJlcXVlc3Quc2lnbmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgYWJvcnRYaHIpO1xuXG4gICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAvLyBET05FIChzdWNjZXNzIG9yIGZhaWx1cmUpXG4gICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgICAgICByZXF1ZXN0LnNpZ25hbC5yZW1vdmVFdmVudExpc3RlbmVyKCdhYm9ydCcsIGFib3J0WGhyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHhoci5zZW5kKHR5cGVvZiByZXF1ZXN0Ll9ib2R5SW5pdCA9PT0gJ3VuZGVmaW5lZCcgPyBudWxsIDogcmVxdWVzdC5fYm9keUluaXQpO1xuICAgIH0pXG4gIH1cblxuICBmZXRjaC5wb2x5ZmlsbCA9IHRydWU7XG5cbiAgaWYgKCFzZWxmLmZldGNoKSB7XG4gICAgc2VsZi5mZXRjaCA9IGZldGNoO1xuICAgIHNlbGYuSGVhZGVycyA9IEhlYWRlcnM7XG4gICAgc2VsZi5SZXF1ZXN0ID0gUmVxdWVzdDtcbiAgICBzZWxmLlJlc3BvbnNlID0gUmVzcG9uc2U7XG4gIH1cblxuICBleHBvcnRzLkhlYWRlcnMgPSBIZWFkZXJzO1xuICBleHBvcnRzLlJlcXVlc3QgPSBSZXF1ZXN0O1xuICBleHBvcnRzLlJlc3BvbnNlID0gUmVzcG9uc2U7XG4gIGV4cG9ydHMuZmV0Y2ggPSBmZXRjaDtcblxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuXG59KSkpO1xuIiwiaW1wb3J0IHtDb25zdGFudHN9IGZyb20gJy4uLy4uLy4uL3NoYXJlZC9qcy9Db25zdGFudHMnO1xuaW1wb3J0IFByZXNlbnRhdGlvbkJhc2UgZnJvbSAnLi4vLi4vLi4vc2hhcmVkL2pzL2NsYXNzZXMvUHJlc2VudGF0aW9uJztcbmltcG9ydCBNb2JpbGVTZXJ2ZXJCcmlkZ2UgZnJvbSAnLi4vLi4vLi4vc2hhcmVkL2pzL2NsYXNzZXMvTW9iaWxlU2VydmVyQnJpZGdlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJlc2VudGF0aW9uIGV4dGVuZHMgUHJlc2VudGF0aW9uQmFzZXtcblxuICBjb25zdHJ1Y3RvcihkYXRhLCByb2xlLCBzZXR0aW5ncykge1xuICAgIHN1cGVyKGRhdGEsIHJvbGUsIHNldHRpbmdzKTtcbiAgICB0aGlzLiRvdmVybGF5ID0gJChgI292ZXJsYXlgKTtcbiAgfVxuXG4gIGNyZWF0ZU1vYmlsZVNlcnZlckJyaWRnZSgpIHtcbiAgICByZXR1cm4gbmV3IE1vYmlsZVNlcnZlckJyaWRnZSh0aGlzLCB0aGlzLnNldHRpbmdzKTtcbiAgfVxuXG4gIGhhbmRsZU1vYmlsZVNlcnZlck1lc3NhZ2UobWVzc2FnZSkge1xuICAgIGlmKCFtZXNzYWdlLmNvbnRlbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYobWVzc2FnZS5jb250ZW50LmFjdGlvbiA9PT0gYHNldEN1cnJlbnRTbGlkZUluZGV4YCkge1xuICAgICAgdGhpcy5zZXRDdXJyZW50U2xpZGVJbmRleChtZXNzYWdlLmNvbnRlbnQuY3VycmVudFNsaWRlSW5kZXgpO1xuICAgIH0gZWxzZSBpZihtZXNzYWdlLmNvbnRlbnQuYWN0aW9uID09PSBDb25zdGFudHMuQkxJTkspIHtcbiAgICAgIHRoaXMuYmxpbmsobWVzc2FnZS5jb250ZW50LnRleHQsIG1lc3NhZ2UuY29udGVudC5iYWNrZ3JvdW5kQ29sb3IpO1xuICAgIH1cbiAgfVxuXG4gIHNldEN1cnJlbnRTbGlkZUluZGV4KGluZGV4KSB7XG4gICAgc3VwZXIuc2V0Q3VycmVudFNsaWRlSW5kZXgoaW5kZXgpO1xuICAgIGlmKHRoaXMuJG92ZXJsYXkpIHtcbiAgICAgIHRoaXMuJG92ZXJsYXkucmVtb3ZlQ2xhc3MoYGFjdGl2ZWApO1xuICAgIH1cbiAgICBpZih0aGlzLmJsaW5rSW50ZXJ2YWwpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5ibGlua0ludGVydmFsKTtcbiAgICB9XG4gIH1cblxuICBibGluayh0ZXh0LCBiYWNrZ3JvdW5kQ29sb3IpIHtcbiAgICAvL292ZXJsYXkgaW1wb3J0YW50LCBibGlua2luZyB0ZXh0XG4gICAgdGhpcy4kb3ZlcmxheS5maW5kKGAuY29udGVudGApLmh0bWwodGV4dCk7XG4gICAgdGhpcy4kb3ZlcmxheS5hZGRDbGFzcyhgYWN0aXZlYCk7XG4gICAgaWYodGhpcy5ibGlua0ludGVydmFsKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuYmxpbmtJbnRlcnZhbCk7XG4gICAgfVxuICAgIHRoaXMuYmxpbmtJbnRlcnZhbCA9IHNldEludGVydmFsKHRoaXMuYmxpbmtUb2dnbGUuYmluZCh0aGlzLCBiYWNrZ3JvdW5kQ29sb3IpLCA1MDApO1xuICB9XG5cbiAgYmxpbmtUb2dnbGUoYmFja2dyb3VuZENvbG9yKSB7XG4gICAgdGhpcy4kb3ZlcmxheS50b2dnbGVDbGFzcyhgYmxpbmstb25gKTtcbiAgICBpZih0aGlzLiRvdmVybGF5Lmhhc0NsYXNzKGBibGluay1vbmApKSB7XG4gICAgICB0aGlzLiRvdmVybGF5LmNzcyhgYmFja2dyb3VuZC1jb2xvcmAsIGJhY2tncm91bmRDb2xvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuJG92ZXJsYXkuY3NzKGBiYWNrZ3JvdW5kLWNvbG9yYCwgYGApO1xuICAgIH1cbiAgfVxuXG59XG4iLCJpbXBvcnQgUHJlc2VudGF0aW9uIGZyb20gJy4vY2xhc3Nlcy9QcmVzZW50YXRpb24nO1xuaW1wb3J0IGZldGNoIGZyb20gJ2lzb21vcnBoaWMtZmV0Y2gnO1xuXG4oKCkgPT4ge1xuXG4gIGNvbnN0IGluaXQgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2V0dGluZ3MgPSB7XG4gICAgICBwcmVzZW50YXRpb25QYXRoOiBgL2AsXG4gICAgICBtb2JpbGVTZXJ2ZXJVcmw6IGBgXG4gICAgfTtcbiAgICAvL2dldCBzbGlkZXMgYnkgeG1saHR0cHJlcXVlc3RcbiAgICBmZXRjaChgL2RhdGEuanNvbj90PSR7ICBEYXRlLm5vdygpfWApXG4gICAgICAudGhlbihkYXRhID0+IGRhdGEuanNvbigpKVxuICAgICAgLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgIG5ldyBQcmVzZW50YXRpb24oZGF0YSwgYG1vYmlsZWAsIHNldHRpbmdzKTtcbiAgICAgIH0pO1xuICB9O1xuXG4gIGluaXQoKTtcbn0pKCk7XG4iLCJleHBvcnQgY29uc3QgQ29uc3RhbnRzID0ge1xuICBHT19UT19QUkVWSU9VU19TTElERTogYGdvVG9QcmV2aW91c1NsaWRlYCxcbiAgR09fVE9fTkVYVF9TTElERTogYGdvVG9OZXh0U2xpZGVgLFxuICBTRVRfU0xJREVTOiBgc2V0U2xpZGVzYCxcbiAgU0VUX0NVUlJFTlRfU0xJREVfSU5ERVg6IGBzZXRDdXJyZW50U2xpZGVJbmRleGAsXG5cbiAgTUVTU0FHRTogYG1lc3NhZ2VgLFxuICBTT0NLRVRfU0VORDogYHNvY2tldFNlbmRgLFxuICBTT0NLRVRfUkVDRUlWRTogYHNvY2tldFJlY2VpdmVgLFxuICBKT0lOX1NMSURFX1JPT006IGBqb2luU2xpZGVSb29tYCxcbiAgTEVBVkVfU0xJREVfUk9PTTogYGxlYXZlU2xpZGVSb29tYCxcblxuICBST0xFX1BSRVNFTlRBVElPTjogYHByZXNlbnRhdGlvbmAsXG4gIFJPTEVfTU9CSUxFOiBgbW9iaWxlYCxcblxuICBTVEFURV9BQ1RJVkU6IGBhY3RpdmVgLFxuICBTVEFURV9JTkFDVElWRTogYGluYWN0aXZlYCxcblxuICBTRVRfU1VCU1RBVEU6IGBzZXRTdWJzdGF0ZWAsXG5cbiAgQ0hJTERfQVBQX1NBVkVfQ09ERTogYGNoaWxkQXBwU2F2ZUNvZGVgLFxuICBDSElMRF9BUFBfUlVOX0NPREU6IGBjaGlsZEFwcFJ1bkNvZGVgLFxuICBDSElMRF9BUFBfU1RET1VUX0RBVEE6IGBjaGlsZEFwcFN0ZG91dERhdGFgLFxuICBDSElMRF9BUFBfU1RERVJSX0RBVEE6IGBjaGlsZEFwcFN0ZGVyckRhdGFgLFxuXG4gIE9QRU5fQ09NTUFORF9MSU5FOiBgb3BlbkNvbW1hbmRMaW5lYCxcbiAgT1BFTl9DQU1FUkE6IGBvcGVuQ2FtZXJhYCxcblxuICBCTElOSzogYGJsaW5rYCxcblxuICBIRUFSVF9SQVRFX1BPTEFSOiBgaGVhcnRSYXRlUG9sYXJgLFxuXG4gIFNFVF9URUFNOiBgc2V0VGVhbWAsXG4gIFVQREFURV9NT1RJT046IGB1cGRhdGVNb3Rpb25gLFxuXG4gIFlPVV9XSU46IGB5b3VXaW5gLFxuICBZT1VfTE9TRTogYHlvdUxvc2VgLFxuXG4gIFNIQUtFX1lPVVJfUEhPTkVTX0lOVFJPOiBgc2hha2VZb3VyUGhvbmVzSW50cm9gLFxuICBTSEFLRV9ZT1VSX1BIT05FU19HQU1FOiBgc2hha2VZb3VyUGhvbmVzR2FtZWAsXG4gIFNIQUtFX1lPVVJfUEhPTkVTX0ZJTklTSEVEOiBgc2hha2VZb3VyUGhvbmVzRmluaXNoZWRgLFxuXG4gIFNIQUtFX1lPVVJfUEhPTkVTX0NMSUVOVF9BRERFRDogYHNoYWtlWW91clBob25lc0NsaWVudEFkZGVkYCxcbiAgU0hBS0VfWU9VUl9QSE9ORVNfQ0xJRU5UX1JFTU9WRUQ6IGBzaGFrZVlvdXJQaG9uZXNDbGllbnRSZW1vdmVkYCxcbiAgU0hBS0VfWU9VUl9QSE9ORVNfQ0xJRU5UX0xJU1Q6IGBzaGFrZVlvdXJQaG9uZXNDbGllbnRMaXN0YCxcbiAgU0hBS0VfWU9VUl9QSE9ORVNfQ0xJRU5UX1VQREFURTogYHNoYWtlWW91clBob25lc0NsaWVudFVwZGF0ZWBcbn07XG4iLCJpbXBvcnQgZmV0Y2ggZnJvbSAnaXNvbW9ycGhpYy1mZXRjaCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vYmlsZVNlcnZlckJyaWRnZSB7XG5cbiAgY29uc3RydWN0b3IocHJlc2VudGF0aW9uLCBzZXR0aW5ncykge1xuICAgIHRoaXMucHJlc2VudGF0aW9uID0gcHJlc2VudGF0aW9uO1xuICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB0aGlzLmNvbm5lY3QoKTtcbiAgfVxuXG4gIGNvbm5lY3QoKSB7XG4gICAgaWYgKCF0aGlzLnNldHRpbmdzLm1vYmlsZVNlcnZlclVybCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhgTW9iaWxlU2VydmVyQnJpZGdlLmNvbm5lY3RgKTtcbiAgICAvL2NvbnNvbGUud2FybignTW9iaWxlU2VydmVyQnJpZGdlIGRpc2FibGVkJyk7XG4gICAgLy9yZXR1cm47XG4gICAgLy9wb3N0IHRvIHRoZSBhcGlcbiAgICBmZXRjaChgJHt0aGlzLnNldHRpbmdzLm1vYmlsZVNlcnZlclVybH0vbG9naW5gLCB7XG4gICAgICBtZXRob2Q6IGBQT1NUYCxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0TG9naW5DcmVkZW50aWFscygpKSxcbiAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHsnQ29udGVudC1UeXBlJzogYGFwcGxpY2F0aW9uL2pzb25gfSlcbiAgICB9KVxuICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcbiAgICAudGhlbihyZXN1bHQgPT4gdGhpcy5sb2dpbkhhbmRsZXIocmVzdWx0KSlcbiAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgLy9yZXRyeSBhZnRlciBvbmUgc2Vjb25kXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuY29ubmVjdCgpLCAxMDAwKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldExvZ2luQ3JlZGVudGlhbHMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGVtYWlsOiB0aGlzLnNldHRpbmdzLm1vYmlsZVNlcnZlclVzZXJuYW1lLFxuICAgICAgcGFzc3dvcmQ6IHRoaXMuc2V0dGluZ3MubW9iaWxlU2VydmVyUGFzc3dvcmQsXG4gICAgfTtcbiAgfVxuXG4gIGxvZ2luSGFuZGxlcihyZXN1bHQpIHtcbiAgICB0aGlzLnRva2VuID0gcmVzdWx0LnRva2VuO1xuICAgIHRoaXMuc29ja2V0ID0gaW8odGhpcy5zZXR0aW5ncy5tb2JpbGVTZXJ2ZXJVcmwsIHtcbiAgICAgIHF1ZXJ5OiBgdG9rZW49JHsgIHRoaXMudG9rZW59YCxcbiAgICAgIHJlY29ubmVjdGlvbjogZmFsc2UsXG4gICAgICBmb3JjZU5ldzogdHJ1ZVxuICAgIH0pO1xuICAgIHRoaXMuc29ja2V0Lm9uKGBjb25uZWN0YCwgdGhpcy5zb2NrZXRDb25uZWN0SGFuZGxlci5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLnNvY2tldC5vbihgZGlzY29ubmVjdGAsIHRoaXMuc29ja2V0RGlzY29ubmVjdEhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5zb2NrZXQub24oYG1lc3NhZ2VgLCB0aGlzLnNvY2tldE1lc3NhZ2VIYW5kbGVyLmJpbmQodGhpcykpO1xuICB9XG5cbiAgc29ja2V0Q29ubmVjdEhhbmRsZXIoKSB7XG4gICAgY29uc29sZS5sb2coYE1vYmlsZVNlcnZlckJyaWRnZS5zb2NrZXRDb25uZWN0SGFuZGxlcmApO1xuICAgIHRoaXMucHJlc2VudGF0aW9uLm1vYmlsZVNlcnZlckJyaWRnZUNvbm5lY3RlZCgpO1xuICB9XG5cbiAgc29ja2V0RGlzY29ubmVjdEhhbmRsZXIoKSB7XG4gICAgdGhpcy5jb25uZWN0KCk7XG4gIH1cblxuICB0cnlUb1NlbmQoKSB7XG4gICAgaWYodGhpcy5zb2NrZXQpIHtcbiAgICAgIHRoaXMuc29ja2V0LmVtaXQuYXBwbHkodGhpcy5zb2NrZXQsIGFyZ3VtZW50cyk7XG4gICAgfVxuICB9XG5cbiAgc29ja2V0TWVzc2FnZUhhbmRsZXIobWVzc2FnZSkge1xuICAgIHRoaXMucHJlc2VudGF0aW9uLm1vYmlsZVNlcnZlck1lc3NhZ2VIYW5kbGVyKG1lc3NhZ2UpO1xuICB9XG59XG4iLCJpbXBvcnQge0NvbnN0YW50c30gZnJvbSAnLi4vQ29uc3RhbnRzJztcbmltcG9ydCBTbGlkZUJyaWRnZSBmcm9tICcuL1NsaWRlQnJpZGdlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJlc2VudGF0aW9uIHtcbiAgLypcbiAgICogZGF0YToganNvbiBvYmplY3Qgd2l0aCBzbGlkZXMgYXJyYXkgcHJvcGVydHlcbiAgICogcm9sZTogbW9iaWxlIG9yIHByZXNlbnRhdGlvblxuICAgKi9cbiAgY29uc3RydWN0b3IoZGF0YSwgcm9sZSwgc2V0dGluZ3MpIHtcbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgIHRoaXMucm9sZSA9IHJvbGU7XG4gICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgICQoYCNwcmVzZW50YXRpb25gKS5hdHRyKGBkYXRhLXByZXNlbnRhdGlvbi1zZXR0aW5nc2AsIEpTT04uc3RyaW5naWZ5KHNldHRpbmdzKSk7XG4gICAgdGhpcy5jdXJyZW50U2xpZGVJbmRleCA9IC0xO1xuICAgIHRoaXMuc2xpZGVIb2xkZXJzID0gW107XG4gICAgdGhpcy5udW1TbGlkZUhvbGRlcnMgPSAzO1xuICAgIHRoaXMuc2xpZGVCcmlkZ2VzID0gW107XG4gICAgdGhpcy5zbGlkZUJyaWRnZXNCeVNsaWRlTmFtZSA9IHt9O1xuXG4gICAgdGhpcy5jcmVhdGVTbGlkZUhvbGRlcnMoKTtcbiAgICB0aGlzLmNyZWF0ZVNsaWRlQnJpZGdlcyh0aGlzLmRhdGEpO1xuXG4gICAgdGhpcy5tb2JpbGVTZXJ2ZXJCcmlkZ2UgPSB0aGlzLmNyZWF0ZU1vYmlsZVNlcnZlckJyaWRnZSgpO1xuICAgIHRoaXMuc3RhcnRMaXN0ZW5pbmdGb3JNZXNzYWdlcygpO1xuXG4gICAgdGhpcy5zZXRDdXJyZW50U2xpZGVJbmRleCgwKTtcbiAgfVxuXG4gIHN0YXJ0TGlzdGVuaW5nRm9yTWVzc2FnZXMoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYG1lc3NhZ2VgLCB0aGlzLnNsaWRlTWVzc2FnZUhhbmRsZXIuYmluZCh0aGlzKSwgZmFsc2UpO1xuICB9XG5cbiAgY3JlYXRlU2xpZGVIb2xkZXJzKCkge1xuICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLm51bVNsaWRlSG9sZGVyczsgaSsrKSB7XG4gICAgICBjb25zdCAkc2xpZGVIb2xkZXIgPSAkKGA8ZGl2IGNsYXNzPVwic2xpZGUtZnJhbWVcIiAvPmApO1xuICAgICAgdGhpcy5zbGlkZUhvbGRlcnMucHVzaCgkc2xpZGVIb2xkZXIpO1xuICAgICAgJChgI3ByZXNlbnRhdGlvbmApLmFwcGVuZCgkc2xpZGVIb2xkZXIpO1xuICAgIH1cbiAgfVxuXG4gIGNyZWF0ZVNsaWRlQnJpZGdlcyhkYXRhKSB7XG4gICAgY29uc3QgbnVtU2xpZGVzID0gZGF0YS5zbGlkZXMubGVuZ3RoO1xuICAgIGZvcihsZXQgaSA9IDA7IGkgPCBudW1TbGlkZXM7IGkrKykge1xuICAgICAgY29uc3Qgc2xpZGVCcmlkZ2UgPSB0aGlzLmNyZWF0ZVNsaWRlQnJpZGdlKGRhdGEuc2xpZGVzW2ldKTtcbiAgICAgIHRoaXMuc2xpZGVCcmlkZ2VzLnB1c2goc2xpZGVCcmlkZ2UpO1xuICAgICAgdGhpcy5zbGlkZUJyaWRnZXNCeVNsaWRlTmFtZVtzbGlkZUJyaWRnZS5uYW1lXSA9IHNsaWRlQnJpZGdlO1xuICAgIH1cbiAgfVxuXG4gIGNyZWF0ZVNsaWRlQnJpZGdlKHNsaWRlKSB7XG4gICAgcmV0dXJuIG5ldyBTbGlkZUJyaWRnZShzbGlkZSk7XG4gIH1cblxuICBzbGlkZU1lc3NhZ2VIYW5kbGVyKGV2ZW50KSB7XG4gICAgaWYoIWV2ZW50LmRhdGEpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc3dpdGNoKGV2ZW50LmRhdGEuYWN0aW9uKSB7XG4gICAgY2FzZSBDb25zdGFudHMuU09DS0VUX1NFTkQ6XG4gICAgICBpZih0aGlzLm1vYmlsZVNlcnZlckJyaWRnZSkge1xuICAgICAgICB0aGlzLm1vYmlsZVNlcnZlckJyaWRnZS50cnlUb1NlbmQoQ29uc3RhbnRzLk1FU1NBR0UsIGV2ZW50LmRhdGEubWVzc2FnZSk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICBtb2JpbGVTZXJ2ZXJCcmlkZ2VDb25uZWN0ZWQoKSB7XG4gICAgLy9qb2luIHRoZSByb29tcyBvZiB0aGUgc2xpZGVIb2xkZXJzXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMubnVtU2xpZGVIb2xkZXJzOyBpKyspIHtcbiAgICAgIHRoaXMubW9iaWxlU2VydmVyQnJpZGdlLnRyeVRvU2VuZChDb25zdGFudHMuSk9JTl9TTElERV9ST09NLCAkKHRoaXMuc2xpZGVIb2xkZXJzW2ldKS5hdHRyKGBkYXRhLW5hbWVgKSk7XG4gICAgfVxuICB9XG5cbiAgbW9iaWxlU2VydmVyTWVzc2FnZUhhbmRsZXIobWVzc2FnZSkge1xuICAgIGlmKG1lc3NhZ2UudGFyZ2V0LnNsaWRlKSB7XG4gICAgICAvL3NsaWRlIGhhcyB0byBoYW5kbGUgdGhlIG1lc3NhZ2VcbiAgICAgIGNvbnN0IHNsaWRlQnJpZGdlID0gdGhpcy5nZXRTbGlkZUJyaWRnZUJ5TmFtZShtZXNzYWdlLnRhcmdldC5zbGlkZSk7XG4gICAgICBpZihzbGlkZUJyaWRnZSkge1xuICAgICAgICBzbGlkZUJyaWRnZS50cnlUb1Bvc3RNZXNzYWdlKHtcbiAgICAgICAgICBhY3Rpb246IENvbnN0YW50cy5TT0NLRVRfUkVDRUlWRSxcbiAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvL3ByZXNlbnRhdGlvbiBoYXMgdG8gaGFuZGxlIHRoZSBtZXNzYWdlXG4gICAgICB0aGlzLmhhbmRsZU1vYmlsZVNlcnZlck1lc3NhZ2UobWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlTW9iaWxlU2VydmVyTWVzc2FnZShtZXNzYWdlKSB7XG4gICAgY29uc29sZS5sb2coYFtzaGFyZWQvUHJlc2VudGF0aW9uXSBoYW5kbGVNb2JpbGVTZXJ2ZXJNZXNzYWdlYCwgbWVzc2FnZSk7XG4gIH1cblxuICBnZXRTbGlkZUJyaWRnZUJ5SW5kZXgoaW5kZXgpIHtcbiAgICBpZihpbmRleCA+PSAwICYmIGluZGV4IDwgdGhpcy5zbGlkZUJyaWRnZXMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gdGhpcy5zbGlkZUJyaWRnZXNbaW5kZXhdO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBnZXRTbGlkZUJyaWRnZUJ5TmFtZShzbGlkZU5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy5zbGlkZUJyaWRnZXNCeVNsaWRlTmFtZVtzbGlkZU5hbWVdO1xuICB9XG5cbiAgZ2V0U2xpZGVIb2xkZXJGb3JTbGlkZShzbGlkZSwgc2xpZGVzTm90VG9DbGVhcikge1xuICAgIGlmKHNsaWRlKSB7XG4gICAgICBsZXQgJHNsaWRlSG9sZGVyID0gJChgLnNsaWRlLWZyYW1lW2RhdGEtbmFtZT1cIiR7ICBzbGlkZS5uYW1lICB9XCJdYCk7XG4gICAgICBpZigkc2xpZGVIb2xkZXIubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gJHNsaWRlSG9sZGVyWzBdO1xuICAgICAgfVxuICAgICAgLy9nZXQgYSBmcmVlIHNsaWRlSG9sZGVyXG4gICAgICBjb25zdCBzbGlkZU5hbWVzTm90VG9DbGVhciA9IFtdO1xuICAgICAgJChzbGlkZXNOb3RUb0NsZWFyKS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBvYmope1xuICAgICAgICBzbGlkZU5hbWVzTm90VG9DbGVhci5wdXNoKG9iai5uYW1lKTtcbiAgICAgIH0pO1xuICAgICAgY29uc3QgJHNsaWRlSG9sZGVycyA9ICQoYC5zbGlkZS1mcmFtZWApO1xuICAgICAgZm9yIChsZXQgaSA9ICRzbGlkZUhvbGRlcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgJHNsaWRlSG9sZGVyID0gJCgkc2xpZGVIb2xkZXJzW2ldKTtcbiAgICAgICAgY29uc3QgbmFtZSA9ICRzbGlkZUhvbGRlci5hdHRyKGBkYXRhLW5hbWVgKTtcbiAgICAgICAgaWYoIW5hbWUgfHwgc2xpZGVOYW1lc05vdFRvQ2xlYXIuaW5kZXhPZihuYW1lKSA9PT0gLTEpIHtcbiAgICAgICAgICByZXR1cm4gJHNsaWRlSG9sZGVyWzBdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGdvVG9QcmV2aW91c1NsaWRlKCkge1xuICAgIHRoaXMuc2V0Q3VycmVudFNsaWRlSW5kZXgodGhpcy5jdXJyZW50U2xpZGVJbmRleCAtIDEpO1xuICB9XG5cbiAgZ29Ub05leHRTbGlkZSgpIHtcbiAgICB0aGlzLnNldEN1cnJlbnRTbGlkZUluZGV4KHRoaXMuY3VycmVudFNsaWRlSW5kZXggKyAxKTtcbiAgfVxuXG4gIHNldEN1cnJlbnRTbGlkZUluZGV4KHZhbHVlKSB7XG4gICAgdmFsdWUgPSBNYXRoLm1heCgwLCBNYXRoLm1pbih2YWx1ZSwgdGhpcy5zbGlkZUJyaWRnZXMubGVuZ3RoIC0gMSkpO1xuICAgIGlmKHZhbHVlICE9PSB0aGlzLmN1cnJlbnRTbGlkZUluZGV4KSB7XG4gICAgICB0aGlzLmN1cnJlbnRTbGlkZUluZGV4ID0gdmFsdWU7XG5cbiAgICAgIGNvbnN0IGN1cnJlbnRTbGlkZUJyaWRnZSA9IHRoaXMuZ2V0U2xpZGVCcmlkZ2VCeUluZGV4KHRoaXMuY3VycmVudFNsaWRlSW5kZXgpO1xuICAgICAgY29uc3QgcHJldmlvdXNTbGlkZUJyaWRnZSA9IHRoaXMuZ2V0U2xpZGVCcmlkZ2VCeUluZGV4KHRoaXMuY3VycmVudFNsaWRlSW5kZXggLSAxKTtcbiAgICAgIGNvbnN0IG5leHRTbGlkZUJyaWRnZSA9IHRoaXMuZ2V0U2xpZGVCcmlkZ2VCeUluZGV4KHRoaXMuY3VycmVudFNsaWRlSW5kZXggKyAxKTtcblxuICAgICAgLy9yZW1vdmUgXCJ1c2VkXCIgY2xhc3MgZnJvbSBzbGlkZSBob2xkZXJzXG4gICAgICAkKGAuc2xpZGUtZnJhbWVgKS5yZW1vdmVBdHRyKGBkYXRhLXVzZWRgLCBmYWxzZSk7XG5cbiAgICAgIGNvbnN0IGN1cnJlbnRTbGlkZUhvbGRlciA9IHRoaXMuZ2V0U2xpZGVIb2xkZXJGb3JTbGlkZShjdXJyZW50U2xpZGVCcmlkZ2UsIFtwcmV2aW91c1NsaWRlQnJpZGdlLCBuZXh0U2xpZGVCcmlkZ2VdKTtcbiAgICAgIHRoaXMuc2V0dXBTbGlkZUhvbGRlcihjdXJyZW50U2xpZGVIb2xkZXIsIGN1cnJlbnRTbGlkZUJyaWRnZSwgQ29uc3RhbnRzLlNUQVRFX0FDVElWRSwgMCk7XG5cbiAgICAgIGNvbnN0IHByZXZpb3VzU2xpZGVIb2xkZXIgPSB0aGlzLmdldFNsaWRlSG9sZGVyRm9yU2xpZGUocHJldmlvdXNTbGlkZUJyaWRnZSwgW2N1cnJlbnRTbGlkZUJyaWRnZSwgbmV4dFNsaWRlQnJpZGdlXSk7XG4gICAgICB0aGlzLnNldHVwU2xpZGVIb2xkZXIocHJldmlvdXNTbGlkZUhvbGRlciwgcHJldmlvdXNTbGlkZUJyaWRnZSwgQ29uc3RhbnRzLlNUQVRFX0lOQUNUSVZFLCBgLTEwMCVgKTtcblxuICAgICAgY29uc3QgbmV4dFNsaWRlSG9sZGVyID0gdGhpcy5nZXRTbGlkZUhvbGRlckZvclNsaWRlKG5leHRTbGlkZUJyaWRnZSwgW3ByZXZpb3VzU2xpZGVCcmlkZ2UsIGN1cnJlbnRTbGlkZUJyaWRnZV0pO1xuICAgICAgdGhpcy5zZXR1cFNsaWRlSG9sZGVyKG5leHRTbGlkZUhvbGRlciwgbmV4dFNsaWRlQnJpZGdlLCBDb25zdGFudHMuU1RBVEVfSU5BQ1RJVkUsIGAxMDAlYCk7XG5cbiAgICAgIC8vY2xlYXIgYXR0cmlidXRlcyBvZiB1bnVzZWQgc2xpZGUgZnJhbWVzXG4gICAgICAkKGAuc2xpZGUtZnJhbWVgKS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBzbGlkZUhvbGRlcil7XG4gICAgICAgIGlmKCEkKHNsaWRlSG9sZGVyKS5hdHRyKGBkYXRhLXVzZWRgKSkge1xuICAgICAgICAgICQoc2xpZGVIb2xkZXIpLnJlbW92ZUF0dHIoYGRhdGEtdXNlZGApLnJlbW92ZUF0dHIoYGRhdGEtbmFtZWApLnJlbW92ZUF0dHIoYGRhdGEtc3JjYCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvL2FsbCBvdGhlciBzbGlkZUhvbGRlciBicmlkZ2VzIHNob3VsZCBiZSB1bmxpbmtlZCBmcm9tIHRoZWlyIHNsaWRlSG9sZGVyXG4gICAgICB0aGlzLnNsaWRlQnJpZGdlcy5mb3JFYWNoKGZ1bmN0aW9uKHNsaWRlQnJpZGdlKXtcbiAgICAgICAgaWYoc2xpZGVCcmlkZ2UgPT09IGN1cnJlbnRTbGlkZUJyaWRnZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZihzbGlkZUJyaWRnZSA9PT0gcHJldmlvdXNTbGlkZUJyaWRnZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZihzbGlkZUJyaWRnZSA9PT0gbmV4dFNsaWRlQnJpZGdlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNsaWRlQnJpZGdlLnNsaWRlSG9sZGVyID0gbnVsbDtcbiAgICAgIH0pO1xuXG4gICAgICBiZWFuLmZpcmUodGhpcywgQ29uc3RhbnRzLlNFVF9DVVJSRU5UX1NMSURFX0lOREVYLCBbdGhpcy5jdXJyZW50U2xpZGVJbmRleF0pO1xuICAgIH1cbiAgfVxuXG4gIHNldHVwU2xpZGVIb2xkZXIoc2xpZGVIb2xkZXIsIHNsaWRlQnJpZGdlLCBzdGF0ZSwgbGVmdCkge1xuICAgIGlmKHNsaWRlSG9sZGVyKSB7XG4gICAgICBsZXQgc3JjID0gYHNsaWRlcy8keyAgc2xpZGVCcmlkZ2UubmFtZSAgfS5odG1sYDtcbiAgICAgIGlmKHNsaWRlQnJpZGdlLmRhdGFbdGhpcy5yb2xlXSAmJiBzbGlkZUJyaWRnZS5kYXRhW3RoaXMucm9sZV0udXJsKSB7XG4gICAgICAgIHNyYyA9IHNsaWRlQnJpZGdlLmRhdGFbdGhpcy5yb2xlXS51cmw7XG4gICAgICB9XG4gICAgICBzcmMgPSB0aGlzLnByb2Nlc3NTbGlkZVNyYyhzcmMpO1xuICAgICAgaWYoc2xpZGVCcmlkZ2UuaXNBbHJlYWR5Q29ycmVjdGx5QXR0YWNoZWQoc2xpZGVIb2xkZXIsIHNyYykpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhzbGlkZUJyaWRnZS5uYW1lICsgJyBhbHJlYWR5IGF0dGFjaGVkJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmF0dGFjaFRvU2xpZGVIb2xkZXIoc2xpZGVIb2xkZXIsIHNsaWRlQnJpZGdlLCBzcmMpO1xuICAgICAgfVxuICAgICAgc2xpZGVCcmlkZ2Uuc2V0U3RhdGUoc3RhdGUpO1xuICAgICAgJChzbGlkZUhvbGRlcikuY3NzKGBsZWZ0YCwgbGVmdCk7XG4gICAgICAkKHNsaWRlSG9sZGVyKS5hdHRyKGBkYXRhLXVzZWRgLCAxKTtcbiAgICB9XG4gIH1cblxuICBhdHRhY2hUb1NsaWRlSG9sZGVyKHNsaWRlSG9sZGVyLCBzbGlkZUJyaWRnZSwgc3JjKSB7XG4gICAgLy9saXN0ZW4gZm9yIGV2ZW50cyBvbiB0aGlzIHNsaWRlSG9sZGVyXG4gICAgJChzbGlkZUhvbGRlcikub2ZmKGBtZXNzYWdlLWZyb20tc2xpZGVgKTtcbiAgICAkKHNsaWRlSG9sZGVyKS5vbihgbWVzc2FnZS1mcm9tLXNsaWRlYCwgKGV2ZW50LCBtZXNzYWdlKSA9PiAge1xuICAgICAgdGhpcy5zbGlkZU1lc3NhZ2VIYW5kbGVyKHtkYXRhOiBtZXNzYWdlfSk7XG4gICAgfSk7XG4gICAgLy9sZWF2ZSBwcmV2aW91cyBjaGFubmVsIG9mIHRoaXMgc2xpZGVIb2xkZXJcbiAgICBpZih0aGlzLm1vYmlsZVNlcnZlckJyaWRnZSkge1xuICAgICAgdGhpcy5tb2JpbGVTZXJ2ZXJCcmlkZ2UudHJ5VG9TZW5kKENvbnN0YW50cy5MRUFWRV9TTElERV9ST09NLCAkKHNsaWRlSG9sZGVyKS5hdHRyKGBkYXRhLW5hbWVgKSk7XG4gICAgfVxuICAgIC8vYWRkIHRoZSBqb2luIGFzIGEgY2FsbGJhY2sgZm9yIHRoZSBvbmxvYWQgZXZlbnRcbiAgICBzbGlkZUJyaWRnZS5hdHRhY2hUb1NsaWRlSG9sZGVyKHNsaWRlSG9sZGVyLCBzcmMsIHRoaXMuc2xpZGVMb2FkZWQuYmluZCh0aGlzLCBzbGlkZUhvbGRlciwgc2xpZGVCcmlkZ2UsIHNyYykpO1xuICB9XG5cbiAgc2xpZGVMb2FkZWQoc2xpZGVIb2xkZXIsIHNsaWRlQnJpZGdlKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICAvL2pvaW4gbmV3IGNoYW5uZWxcbiAgICBpZih0aGlzLm1vYmlsZVNlcnZlckJyaWRnZSkge1xuICAgICAgdGhpcy5tb2JpbGVTZXJ2ZXJCcmlkZ2UudHJ5VG9TZW5kKENvbnN0YW50cy5KT0lOX1NMSURFX1JPT00sICQoc2xpZGVIb2xkZXIpLmF0dHIoYGRhdGEtbmFtZWApKTtcbiAgICB9XG4gIH1cblxuICBwcm9jZXNzU2xpZGVTcmMoc3JjKSB7XG4gICAgcmV0dXJuIHNyYztcbiAgfVxuXG4gIGNyZWF0ZU1vYmlsZVNlcnZlckJyaWRnZSgpIHtcbiAgICAvL3RvIGltcGxlbWVudCBpbiBleHRlbmRpbmcgY2xhc3Nlc1xuICB9XG59XG4iLCJpbXBvcnQgZmV0Y2ggZnJvbSAnaXNvbW9ycGhpYy1mZXRjaCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNsaWRlQnJpZGdlIHtcbiAgY29uc3RydWN0b3IoZGF0YSkge1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5uYW1lID0gdGhpcy5kYXRhLm5hbWU7XG4gIH1cblxuICBpc0FscmVhZHlDb3JyZWN0bHlBdHRhY2hlZChzbGlkZUhvbGRlciwgc3JjKSB7XG4gICAgcmV0dXJuICh0aGlzLnNsaWRlSG9sZGVyID09PSBzbGlkZUhvbGRlciAmJiAkKHNsaWRlSG9sZGVyKS5hdHRyKGBkYXRhLW5hbWVgKSA9PT0gdGhpcy5uYW1lICYmICQoc2xpZGVIb2xkZXIpLmF0dHIoYGRhdGEtc3JjYCkgPT09IHNyYyk7XG4gIH1cblxuICBhdHRhY2hUb1NsaWRlSG9sZGVyKHNsaWRlSG9sZGVyLCBzcmMsIGNiKSB7XG4gICAgdGhpcy5zbGlkZUhvbGRlciA9IHNsaWRlSG9sZGVyO1xuICAgIC8vbm90aWZ5IHRoZSBjb250ZW50IGl0IGlzIGJlaW5nIGNsZWFyZWRcbiAgICB0aGlzLnRyeVRvUG9zdE1lc3NhZ2Uoe2FjdGlvbjogYGRlc3Ryb3lgfSk7XG4gICAgLy9jbGVhciB0aGUgY3VycmVudCBjb250ZW50XG4gICAgdGhpcy5zbGlkZUhvbGRlci5pbm5lckhUTUwgPSBgYDtcbiAgICAkKHNsaWRlSG9sZGVyKS5hdHRyKGBkYXRhLW5hbWVgLCB0aGlzLm5hbWUpO1xuICAgICQoc2xpZGVIb2xkZXIpLmFkZENsYXNzKGBsb2FkaW5nYCk7XG5cbiAgICAkKHNsaWRlSG9sZGVyKS5vZmYoYGxvYWRgKTtcbiAgICAkKHNsaWRlSG9sZGVyKS5vbihgbG9hZGAsICgpID0+IHtcbiAgICAgIHRoaXMudHJ5VG9Qb3N0TWVzc2FnZSh7XG4gICAgICAgIGFjdGlvbjogYHNldFN0YXRlYCxcbiAgICAgICAgc3RhdGU6IHRoaXMuc3RhdGVcbiAgICAgIH0pO1xuICAgICAgJChzbGlkZUhvbGRlcikub2ZmKGBsb2FkYCk7XG4gICAgfSk7XG5cbiAgICBpZihzcmMgIT09ICQoc2xpZGVIb2xkZXIpLmF0dHIoYGRhdGEtc3JjYCkpIHtcbiAgICAgIC8vZmV0Y2ggdGhlIGh0bWxcbiAgICAgIGZldGNoKHNyYylcbiAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHJlc3VsdC50ZXh0KCkpXG4gICAgICAgIC50aGVuKHJlc3VsdCA9PiAkKHJlc3VsdCkpXG4gICAgICAgIC50aGVuKCRyZXN1bHQgPT4ge1xuICAgICAgICAgICQoc2xpZGVIb2xkZXIpLmh0bWwoJHJlc3VsdC5odG1sKCkpO1xuICAgICAgICAgICQoc2xpZGVIb2xkZXIpLnJlbW92ZUNsYXNzKGBsb2FkaW5nYCk7XG4gICAgICAgICAgY2IoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICQoc2xpZGVIb2xkZXIpLnJlbW92ZUNsYXNzKGBsb2FkaW5nYCk7XG4gICAgICAgICAgY2IoKTtcbiAgICAgICAgfSk7XG4gICAgICAkKHNsaWRlSG9sZGVyKS5hdHRyKGBkYXRhLXNyY2AsIHNyYyk7XG4gICAgfVxuICB9XG5cbiAgdHJ5VG9Qb3N0TWVzc2FnZShtZXNzYWdlKSB7XG4gICAgaWYoIXRoaXMuc2xpZGVIb2xkZXIpXG4gICAge1xuICAgICAgY29uc29sZS5sb2coYCR7dGhpcy5uYW1lICB9IHBvc3QgZmFpbGApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvL3RyaWdnZXIgd2l0aCBqcXVlcnlcbiAgICAkKHRoaXMuc2xpZGVIb2xkZXIpLnRyaWdnZXIoYG1lc3NhZ2UtdG8tc2xpZGVgLCBtZXNzYWdlKTtcbiAgfVxuXG4gIHNldFN0YXRlKHN0YXRlKSB7XG4gICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgIHRoaXMudHJ5VG9Qb3N0TWVzc2FnZSh7XG4gICAgICBhY3Rpb246IGBzZXRTdGF0ZWAsXG4gICAgICBzdGF0ZTogdGhpcy5zdGF0ZVxuICAgIH0pO1xuICB9XG59XG4iXX0="}